<div class="category-manager-card card">
    <h3>âš™ï¸ Gestion des CatÃ©gories</h3>

    <div *ngIf="errorMessage" class="error-message">
        {{ errorMessage }}
    </div>

    <div class="add-category-form">
        <h4>Ajouter une catÃ©gorie principale</h4>
        <div class="input-group">
            <input 
                type="text" 
                [(ngModel)]="newCategory" 
                (keyup.enter)="addCategory()"
                placeholder="Nom de la nouvelle catÃ©gorie"
                maxlength="30"
            >
            <button (click)="addCategory()" [disabled]="!newCategory.trim()">+ Ajouter</button>
        </div>
    </div>

    <div class="category-list-container">
        <h4>CatÃ©gories et sous-catÃ©gories:</h4>
        <div *ngFor="let catStructure of budgetService.categoryStructure()" class="category-item">
            <div class="category-header">
                <span class="category-name">ğŸ“ {{ catStructure.name }}</span>
                <div class="category-actions">
                    <button 
                        (click)="toggleSubcategoryEditor(catStructure.name)" 
                        class="manage-subcat-button"
                        [class.active]="editingSubcategoriesFor() === catStructure.name">
                        {{ editingSubcategoriesFor() === catStructure.name ? 'âˆ’' : '+' }} Sous-catÃ©gories
                    </button>
                    <button (click)="deleteCategory(catStructure.name)" class="delete-cat-button">ğŸ—‘ï¸</button>
                </div>
            </div>

            <!-- Liste des sous-catÃ©gories -->
            <div class="subcategory-list" *ngIf="catStructure.subcategories.length > 0">
                <div *ngFor="let subcat of catStructure.subcategories" class="subcategory-item">
                    <span class="subcategory-name">â””â”€ {{ subcat }}</span>
                    <button 
                        (click)="deleteSubcategory(catStructure.name, subcat)" 
                        class="delete-subcat-button"
                        title="Supprimer cette sous-catÃ©gorie">
                        âœ•
                    </button>
                </div>
            </div>

            <!-- Ã‰diteur de sous-catÃ©gories -->
            <div class="subcategory-editor" *ngIf="editingSubcategoriesFor() === catStructure.name">
                <div class="input-group">
                    <input 
                        type="text" 
                        [(ngModel)]="newSubcategory" 
                        (keyup.enter)="addSubcategory()"
                        placeholder="Nouvelle sous-catÃ©gorie"
                        maxlength="30"
                    >
                    <button (click)="addSubcategory()" [disabled]="!newSubcategory.trim()">+ Ajouter</button>
                </div>
            </div>
        </div>
    </div>
</div>